# cypress-msteams-reporter

## Cypress Microsoft Teams Reporter

A Microsoft Teams reporter of your test results.  
It uses the allure report generated by cypress-allure-plugin (or any other allure reporter) to send a message in a team channel of your choice with the status of the test run.
Everyone gets a fast, short and well-organized feedback of the latest test execution.  
The message sent to ms-teams include:

- Test run status
- How many test cases failed (if there are any)
- The list of the test cases that failed (if there are any)
- How many test cases are broken (if there are any)
- The list of the test cases that are broken (if there are any)
- A link of the allure report generated, which includes all the necessary details

How ms-teams message looks like

![All test cases passed](/assets/screenshots/report-passed.PNG)
![Some test cases failed](/assets/screenshots/report-failed.PNG)
![Some test cases are broken](/assets/screenshots/report-broken.PNG)

## Installation

```
npm install cypress-teams-reporter --save-dev
```

## Prerequisites

- [allure-commandline](https://www.npmjs.com/package/allure-commandline)
- [cypress-allure-plugin](https://www.npmjs.com/package/@shelex/cypress-allure-plugin) (or any other allure reporter)

## Configuration

Create an incoming webhook for the team channel where you want to get the report. Copy the WEBHOOK URL and add it to your .env file:

```
MS_TEAMS_WEBHOOK_URL = 'yourWebhookUrl'
```

To add the images that you see in the above screenshots as part of your ms-teams messages, copy the folder `assets/images` in the root of your project.

To display in the ms-teams message the name of the application under test and its version when the tests were executed, create a environment.properties file within your allure-results folder. In the file add:

```
Application=Application Under Test
Version=vx.x.x
```

## Usage

```
$ npx cypress-msteams-reporter
```

```
Usage: index [options]

Options:
  -v, --version          output the version number
  --verbose              show log output
  --report-path [type]   define the path of allure report file (default: "./allure-report/widgets/status-chart.json")
  --testEnv-path [type]  define the path of allure report environment properties file (default: "./allure-report/widgets/environment.json")
  --report-url [type]    provide the link for the Test Report (default: "")
  -h, --help             display help for command
```

If the allure report is uploaded somewhere, provide the link using the option `--report-url`. A button 'Open Test Report' will be part of ms-teams message. Onclick it, the allure test report will be opened.
